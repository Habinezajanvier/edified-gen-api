{"version":3,"sources":["../../src/controllers/files.js"],"names":["aws","config","region","S3_BUCKET","process","env","getSignedUrl","req","res","s3","S3","fileName","query","fileType","s3Params","Bucket","Key","Expires","ContentType","ACL","err","data","status","send","returnData","signedRequest","url","msg"],"mappings":";;;;;;;;;AAAA;;AAEAA,mBAAIC,MAAJ,CAAWC,MAAX,GAAoB,WAApB;IAEQC,S,GAAcC,OAAO,CAACC,G,CAAtBF,S;;AAED,IAAMG,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,GAAN,EAAc;AACtC,MAAMC,EAAE,GAAG,IAAIT,mBAAIU,EAAR,EAAX;AACA,MAAMC,QAAQ,GAAGJ,GAAG,CAACK,KAAJ,CAAU,WAAV,CAAjB;AACA,MAAMC,QAAQ,GAAGN,GAAG,CAACK,KAAJ,CAAU,WAAV,CAAjB;AACA,MAAME,QAAQ,GAAG;AACfC,IAAAA,MAAM,EAAEZ,SADO;AAEfa,IAAAA,GAAG,EAAEL,QAFU;AAGfM,IAAAA,OAAO,EAAE,EAHM;AAIfC,IAAAA,WAAW,EAAEL,QAJE;AAKfM,IAAAA,GAAG,EAAE;AALU,GAAjB;AAQAV,EAAAA,EAAE,CAACH,YAAH,CAAgB,WAAhB,EAA6BQ,QAA7B,EAAuC,UAACM,GAAD,EAAMC,IAAN,EAAe;AACpD,QAAID,GAAJ,EAAS;AACP,aAAOZ,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEH,QAAAA,GAAG,EAAE;AAAP,OAArB,CAAP;AACD;;AACD,QAAMI,UAAU,GAAG;AACjBC,MAAAA,aAAa,EAAEJ,IADE;AAEjBK,MAAAA,GAAG,oBAAavB,SAAb,+BAA2CQ,QAA3C;AAFc,KAAnB;AAIAH,IAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEI,MAAAA,GAAG,EAAE,6BAAP;AAAsCN,MAAAA,IAAI,EAAEG;AAA5C,KAArB;AACD,GATD;AAUD,CAtBI","sourcesContent":["import aws from \"aws-sdk\";\r\n\r\naws.config.region = \"us-east-2\";\r\n\r\nconst { S3_BUCKET } = process.env;\r\n\r\nexport const getSignedUrl = (req, res) => {\r\n    const s3 = new aws.S3();\r\n    const fileName = req.query[\"file-name\"];\r\n    const fileType = req.query[\"file-type\"];\r\n    const s3Params = {\r\n      Bucket: S3_BUCKET,\r\n      Key: fileName,\r\n      Expires: 60,\r\n      ContentType: fileType,\r\n      ACL: \"public-read\"\r\n    };\r\n\r\n    s3.getSignedUrl(\"putObject\", s3Params, (err, data) => {\r\n      if (err) {\r\n        return res.status(400).send({ err: \"Can not get signed request\" });\r\n      }\r\n      const returnData = {\r\n        signedRequest: data,\r\n        url: `https://${S3_BUCKET}.s3.amazonaws.com/${fileName}`\r\n      };\r\n      res.status(201).send({ msg: \"Signed url request returned\", data: returnData });\r\n    });\r\n  }\r\n"],"file":"files.js"}